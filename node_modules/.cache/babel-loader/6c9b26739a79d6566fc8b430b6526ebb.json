{"ast":null,"code":"import _slicedToArray from\"/home/lucaswerner/repositories/github-personal/recipes-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState,useContext}from'react';import{Link,Redirect}from'react-router-dom';import{Card,CardFilters,Header,Footer,Loading}from'../../components';import{FoodsContext}from'../../contexts/FoodsContext';import{fetchFoodsApi,handleFoodsData}from'../../services/APIs/FOODS_API';var manageState=function manageState(loading,foods,error){if(loading)return/*#__PURE__*/React.createElement(Loading,null);if(error.length>0)return/*#__PURE__*/React.createElement(\"h1\",{\"data-testid\":\"error-foods-page\"},\"Something Went Wrong\");if(foods.length===1&&!foods[0].name.includes('Goat'))return/*#__PURE__*/React.createElement(Redirect,{to:\"/comidas/\".concat(foods[0].id)});return false;};function FoodsPage(){var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),categories=_useState6[0],setCategories=_useState6[1];var _useContext=useContext(FoodsContext),_useContext2=_slicedToArray(_useContext,2),_useContext2$=_useContext2[0],foods=_useContext2$.foods,foodFilter=_useContext2$.foodFilter,_useContext2$2=_useContext2[1],setFoods=_useContext2$2.setFoods,setFoodFilter=_useContext2$2.setFoodFilter;useEffect(function(){fetchFoodsApi(foodFilter).then(function(_ref){var meals=_ref.meals;return setFoods(meals.map(function(food){return handleFoodsData(food);}));}).then(function(){return setLoading(false);}).catch(function(err){alert('Sinto muito, não encontramos nenhuma receita para esses filtros.');setError(err);});},[setFoods,setLoading,foodFilter]);useEffect(function(){fetchFoodsApi('list.php?c=list').then(function(_ref2){var meals=_ref2.meals;return meals.map(function(_ref3){var category=_ref3.strCategory;return{category:category};});}).then(function(arr){setCategories(arr);setLoading(false);}).catch(function(err){console.log(err);setError(err);});},[setLoading]);return manageState(loading,foods,error)||/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Header,{titleTag:\"Comidas\",filterMode:setFoodFilter}),/*#__PURE__*/React.createElement(CardFilters,{categories:categories,filterMode:setFoodFilter}),foods.slice(0,12).map(function(_ref4,index){var id=_ref4.id,name=_ref4.name,srcImage=_ref4.srcImage;return/*#__PURE__*/React.createElement(Link,{key:id,to:\"/comidas/\".concat(id)},/*#__PURE__*/React.createElement(Card,{name:name,index:index,srcImage:srcImage}));}),/*#__PURE__*/React.createElement(Footer,null));}export default FoodsPage;","map":{"version":3,"sources":["/home/lucaswerner/repositories/github-personal/recipes-app/src/pages/FoodsPage/index.js"],"names":["React","useEffect","useState","useContext","Link","Redirect","Card","CardFilters","Header","Footer","Loading","FoodsContext","fetchFoodsApi","handleFoodsData","manageState","loading","foods","error","length","name","includes","id","FoodsPage","setLoading","setError","categories","setCategories","foodFilter","setFoods","setFoodFilter","then","meals","map","food","catch","err","alert","category","strCategory","arr","console","log","slice","index","srcImage"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useContext } from 'react';\nimport { Link, Redirect } from 'react-router-dom';\nimport { Card, CardFilters, Header, Footer, Loading } from '../../components';\nimport { FoodsContext } from '../../contexts/FoodsContext';\nimport {\n  fetchFoodsApi,\n  handleFoodsData,\n} from '../../services/APIs/FOODS_API';\n\nconst manageState = (loading, foods, error) => {\n  if (loading) return <Loading />;\n  if (error.length > 0) return <h1 data-testid=\"error-foods-page\">Something Went Wrong</h1>;\n  if (foods.length === 1 && !foods[0].name.includes('Goat')) return <Redirect to={`/comidas/${foods[0].id}`} />;\n  return false;\n};\n\nfunction FoodsPage() {\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [categories, setCategories] = useState([]);\n  const [{ foods, foodFilter }, { setFoods, setFoodFilter }] = useContext(FoodsContext);\n\n  useEffect(() => {\n    fetchFoodsApi(foodFilter)\n      .then(({ meals }) => setFoods(meals.map((food) => handleFoodsData(food))))\n      .then(() => setLoading(false))\n      .catch((err) => {\n        alert('Sinto muito, não encontramos nenhuma receita para esses filtros.');\n        setError(err);\n      });\n  }, [setFoods, setLoading, foodFilter]);\n\n  useEffect(() => {\n    fetchFoodsApi('list.php?c=list')\n      .then(({ meals }) => meals.map(({ strCategory: category }) => ({ category })))\n      .then((arr) => { setCategories(arr); setLoading(false); })\n      .catch((err) => { console.log(err); setError(err); });\n  }, [setLoading]);\n\n  return (\n    manageState(loading, foods, error) ||\n    <div>\n      <Header titleTag=\"Comidas\" filterMode={setFoodFilter} />\n      <CardFilters\n        categories={categories}\n        filterMode={setFoodFilter}\n      />\n      {foods\n        .slice(0, 12)\n        .map(({ id, name, srcImage }, index) => (\n          <Link key={id} to={`/comidas/${id}`}>\n            <Card name={name} index={index} srcImage={srcImage} />\n          </Link>\n        ))}\n      <Footer />\n    </div>\n  );\n}\n\nexport default FoodsPage;\n"]},"metadata":{},"sourceType":"module"}